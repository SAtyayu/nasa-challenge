{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/pc/Desktop/final/src/components/map/fresh-city-map.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useRef } from 'react';\nimport type { City, OptimalSettlement } from '@/lib/types';\n\ninterface CityMapProps {\n  cities: City[];\n  selectedCity: City | null;\n  onSelectCity: (city: City | null) => void;\n}\n\nconst FreshCityMap: React.FC<CityMapProps> = ({ cities, selectedCity, onSelectCity }) => {\n  const mapRef = useRef<HTMLDivElement>(null);\n  const mapInstanceRef = useRef<any>(null);\n\n  useEffect(() => {\n    if (!mapRef.current) return;\n\n    // Load Leaflet dynamically\n    const loadMap = async () => {\n      // Load CSS\n      const link = document.createElement('link');\n      link.rel = 'stylesheet';\n      link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\n      document.head.appendChild(link);\n\n      // Load JS\n      const script = document.createElement('script');\n      script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\n      script.onload = async () => {\n        // Initialize map\n        const L = (window as any).L;\n        const map = L.map(mapRef.current).setView([20, 0], 2);\n\n        // Add tile layer\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n          attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n        }).addTo(map);\n\n        // Load optimal settlements data\n        const optimalSettlements = await fetch('/api/optimal-settlements').then(res => res.json()).catch(() => []);\n\n        // Helper function to get marker color\n        const getMarkerColor = (z_metric: number) => {\n          const hue = (1 - z_metric) * 120;\n          return `hsl(${hue}, 90%, 45%)`;\n        };\n\n        // Add existing city markers\n        cities.forEach(city => {\n          const marker = L.circleMarker([city.latitude, city.longitude], {\n            radius: 12,\n            fillColor: getMarkerColor(city.z_metric),\n            color: 'white',\n            weight: 2,\n            opacity: 1,\n            fillOpacity: 0.8\n          }).addTo(map);\n\n          // Add popup\n          const popupContent = `\n            <div style=\"background: white; padding: 15px; border-radius: 8px; min-width: 300px; max-width: 400px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);\">\n              <div style=\"font-weight: bold; font-size: 18px; margin-bottom: 10px; color: #2c3e50;\">${city.name}</div>\n              <div style=\"font-size: 12px; color: #666; margin-bottom: 15px;\">\n                <div style=\"margin-bottom: 5px;\"><strong>Population:</strong> ${city.population.toLocaleString()}</div>\n                <div style=\"margin-bottom: 5px;\"><strong>Z-Metric:</strong> ${city.z_metric}</div>\n                <div style=\"margin-bottom: 5px;\"><strong>Land Use:</strong> ${city.land_type}</div>\n              </div>\n              <div style=\"border-top: 1px solid #eee; padding-top: 10px;\">\n                <div style=\"font-weight: bold; color: #e74c3c; font-size: 14px; margin-bottom: 8px;\">üåç Environmental Problem:</div>\n                <div style=\"font-size: 11px; color: #666; margin-bottom: 10px; line-height: 1.4;\">${city.environmental_problem}</div>\n                <div style=\"font-weight: bold; color: #27ae60; font-size: 14px; margin-bottom: 8px;\">üí° Solution:</div>\n                <div style=\"font-size: 11px; color: #666; line-height: 1.4;\">${city.environmental_solution}</div>\n              </div>\n            </div>\n          `;\n          \n          marker.bindPopup(popupContent);\n          \n          // Add click handler\n          marker.on('click', () => {\n            onSelectCity(city);\n          });\n        });\n\n        // Add optimal settlement markers\n        optimalSettlements.forEach(settlement => {\n          const marker = L.circleMarker([settlement.latitude, settlement.longitude], {\n            radius: 15,\n            fillColor: '#2ecc71',\n            color: '#27ae60',\n            weight: 3,\n            opacity: 1,\n            fillOpacity: 0.8\n          }).addTo(map);\n\n          // Add popup for settlements\n          const popupContent = `\n            <div style=\"background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; padding: 15px; border-radius: 8px; min-width: 350px; max-width: 450px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);\">\n              <div style=\"font-weight: bold; font-size: 18px; margin-bottom: 10px;\">üèôÔ∏è ${settlement.name}</div>\n              <div style=\"font-size: 12px; margin-bottom: 15px; opacity: 0.9;\">\n                <div style=\"margin-bottom: 5px;\"><strong>Type:</strong> ${settlement.settlement_type}</div>\n                <div style=\"margin-bottom: 5px;\"><strong>Priority Score:</strong> ${settlement.priority_score}/100</div>\n                <div style=\"margin-bottom: 5px;\"><strong>Capacity:</strong> ${settlement.estimated_capacity}</div>\n                <div style=\"margin-bottom: 5px;\"><strong>Timeline:</strong> ${settlement.development_timeline}</div>\n              </div>\n              <div style=\"border-top: 1px solid rgba(255,255,255,0.3); padding-top: 10px;\">\n                <div style=\"font-weight: bold; font-size: 14px; margin-bottom: 8px;\">üå± Environmental Advantages:</div>\n                <div style=\"font-size: 11px; margin-bottom: 10px; line-height: 1.4; opacity: 0.9;\">${settlement.environmental_advantages}</div>\n                <div style=\"font-weight: bold; font-size: 14px; margin-bottom: 8px;\">üèóÔ∏è Infrastructure Potential:</div>\n                <div style=\"font-size: 11px; margin-bottom: 10px; line-height: 1.4; opacity: 0.9;\">${settlement.infrastructure_potential}</div>\n                <div style=\"font-weight: bold; font-size: 14px; margin-bottom: 8px;\">üí° Urban Planning:</div>\n                <div style=\"font-size: 11px; line-height: 1.4; opacity: 0.9;\">${settlement.urban_planning_recommendations}</div>\n              </div>\n            </div>\n          `;\n          \n          marker.bindPopup(popupContent);\n        });\n\n        mapInstanceRef.current = map;\n      };\n      document.head.appendChild(script);\n    };\n\n    loadMap();\n\n    // Cleanup\n    return () => {\n      if (mapInstanceRef.current) {\n        mapInstanceRef.current.remove();\n        mapInstanceRef.current = null;\n      }\n    };\n  }, [cities, onSelectCity]);\n\n  return <div ref={mapRef} className=\"h-full w-full\" />;\n};\n\nexport default FreshCityMap;\n"],"names":[],"mappings":"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","debugId":null}}]
}